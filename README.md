--计算总分排名
WITH TEMP AS (
SELECT RES.RuleName,ORG.OrganName,SUM(RES.Score)/COUNT(RES.RuleName) AS SCORE
FROM VOTE.DBO.AppAppraisements AS APP
LEFT JOIN VOTE.DBO.AppAppraisementResults AS RES ON APP.Id=RES.AppraisementId
LEFT JOIN VOTE.DBO.AppCandidateOrgUnits AS ORG ON RES.CandidateId=ORG.Id
WHERE RES.Category=1 AND APP.Id='845D2034-273C-004A-DE4D-3A0D38E325AD'
GROUP BY RES.RuleName,ORG.OrganName,ORG.Category)
SELECT TEMP.OrganName,SUM(TEMP.SCORE) FROM TEMP 
GROUP BY TEMP.OrganName